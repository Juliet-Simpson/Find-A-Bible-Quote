{% extends "base.html" %}
{% block content %}
<h4 class="center">This page displays the quotes on which you have commented.  Expand each quote to see its comments.  You can edit or delete your own comments here.</h4>

{% if commented_quotes | length > 0 %}

<ul class="collapsible">
    {% for item in commented_quotes %}
    <li>
        <div class="collapsible-header">
            <div class="card-panel collapsible-card">
                <div class="row">
                    <div class="col s5 m4">
                        <h6 class="justify-left">{{ item.quote.book }} {{ item.quote.chapter }} :
                            {{ item.quote.start_verse }}{% if item.quote.end_verse%}-{{item.quote.end_verse}}{% endif %}</h6>
                    </div>
                    <div class="col s7 m8">
                        <h6 class="justify-left theme-small">Theme: <strong>{{ item.quote.theme }}.</strong></h6>
                    </div>
                </div>
                <div class="row">
                    <div class="col s12">
                        <h5>"{{item.quote.text}}"</h5>
                    </div>
                </div>
                <div class="row">
                    <div class="col s6">
                        <strong>Added by:</strong> {{item.quote.added_by}}
                    </div>
                    <div class="col s6 btn-col">
                        <i class="fas fa-caret-down"></i>Comments
                    </div>
                </div>
            </div>
        </div>


        <!-- Comments section -->
        <div class="collapsible-body comment-body">
            <ul>
                {% for comment in item.comments %}
                    <li>
                        <div class="card-panel comment-card">
                            {% if session.user|lower == comment.comment_by|lower %}
                            <div class="row btn-col">
                                <div class="col s12 btn-col">
                                    <a href="#modal1{{comment._id }}" class="btn-small"><i
                                        class="fas fa-pencil-alt modal-trigger"></i></a>
                                    <a href="#modal2{{comment._id}}" class="btn-small modal-trigger"><i
                                            class="far fa-trash-alt"></i></a>
                                </div>
                            </div>
                            {% endif %}
                            <div>
                                {{ comment.comment }}
                            </div>
                            <div class="btn-col">
                                <strong>By: </strong>{{ comment.comment_by }}
                            </div>
                        </div>
                        <!--Edit comment modal-->
        
        <!-- End modal -->
        <!--Confirm delete modal-->
        <div id="modal2{{comment._id}}" class="modal">
            <div class="modal-content">
                <h3>Confirm Delete</h3>
                <h5>Are you sure that you want to delete this comment?</h5>
            </div>
            <div class="modal-footer">
                <a href="#!" class="modal-close btn blue text-shadow">
                    Cancel<i class="far fa-times-circle right"></i></a>
                <a href="{{ url_for('delete_comment', comment_id=comment._id) }}"
                    class="modal-close btn red text-shadow">
                    Delete<i class="fas fa-times-circle right"></i></a>
            </div>
        </div>
                    </li>
                {% endfor %}
            </ul>
        </div>
       
    </li>
    {% endfor %}
</ul>
{% else %}
<h4 class="red-text text-darken-4 center-align">You have not commented on any quotes yet.</h4>
{% endif %}
<br>
{% endblock %}